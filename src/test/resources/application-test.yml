spring:
  application:
    name: woodexcess-api

  # Testcontainers PostgreSQL
  datasource:
    url: jdbc:tc:postgresql:16-alpine:///testdb?TC_DAEMON=true
    username: test
    password: test
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver

  # JPA Configuration
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect

  # Flyway
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration

  # Upload constraints
  servlet:
    multipart:
      enabled: true
      max-file-size: 5MB
      max-request-size: 25MB

  # Cache
  cache:
    type: simple
    cache-names: cep

  # Spring Cloud
  cloud:
    compatibility-verifier:
      enabled: false


jwt:
  secret: d428cb12c786f4fed33f674b12fb9efa4a02aecc293681dcaeec923dd7a1be48f3e9a7e061648382b2be8826436f8773bc174730b354fdf6c59d4bb330398a49
  access-expiration-ms: 900000
  refresh-expiration-ms: 604800000


security:
  refresh-token:
    max-devices: 5
    rotation-enabled: true
    validate-context: true
    reuse-detection: true
  login:
    rate-limit:
      capacity: 100
      refill-tokens: 100
      refill-minutes: 1


app:
  rate-limit:
    login:
      capacity: 100
      refill-tokens: 100
      refill-minutes: 1

    message:
      capacity: 15
      refill-tokens: 1
      refill-minutes: 1

    websocket:
      capacity: 30
      refill-tokens: 5
      refill-minutes: 1

  # Image upload settings
  listing:
    max-images: 10
    max-file-size: 5242880  # 5MB
    allowed-extensions: jpg,jpeg,png,webp
    thumbnail:
      width: 300
      height: 300


aws:
  access-key-id: test-access-key-id
  secret-access-key: test-secret-access-key
  s3:
    bucket-name: test-bucket
    region: us-east-1
    cdn-url: ""


viacep:
  url: viacep.com.br/ws

# Feign Client
feign:
  client:
    config:
      default:
        connectTimeout: 5000
        readTimeout: 5000
        loggerLevel: basic


websocket:
  allowed-origins: http://localhost:3000,http://localhost:5173

logging:
  level:
    root: WARN
    org.hibernate.SQL: WARN
    org.springframework: WARN
    org.springframework.security: DEBUG
    com.z.c.woodexcess_api: INFO
    org.testcontainers: INFO
    com.github.dockerjava: WARN